---
import Header from '../components/Header.astro';

const { title } = Astro.props;

// Obtener la configuración del header guardada o usar valores por defecto
const savedHeaderConfig = typeof localStorage !== 'undefined' 
    ? JSON.parse(localStorage.getItem('headerConfig') || '{}')
    : {};

const headerConfig = {
    title: savedHeaderConfig.title || "Mi Tienda Online",
    subtitle: savedHeaderConfig.subtitle || "Productos + Ofertas ",
    email: savedHeaderConfig.email || "tienda@ejemplo.com",
    profileImage: savedHeaderConfig.profileImage || "/profile.jpg",
    socialLinks: savedHeaderConfig.socialLinks || {}
};
---

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{title}</title>
    <meta name="description" content="Galería de productos">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .fade-in { 
            opacity: 0; 
            animation: fadeIn 0.5s ease-in forwards;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <Header 
        title={headerConfig.title}
        subtitle={headerConfig.subtitle}
        email={headerConfig.email}
        profileImage={headerConfig.profileImage}
        socialLinks={headerConfig.socialLinks}
    />
    <main class="fade-in">
        <slot />
    </main>
    <script>
        // Cargar scripts no críticos de forma asíncrona
        window.addEventListener('load', () => {
            const loadScript = (src) => {
                if (document.querySelector(`script[src="${src}"]`)) return;
                const script = document.createElement('script');
                script.src = src;
                script.async = true;
                document.body.appendChild(script);
            };

            // Cargar scripts adicionales solo si son necesarios
            if (window.location.pathname.includes('admin')) {
                loadScript('/js/admin-features.js');
            }
        });
    </script>
</body>
</html>
